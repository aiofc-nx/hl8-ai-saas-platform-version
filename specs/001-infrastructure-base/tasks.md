# ä»»åŠ¡æ¸…å•ï¼šåŸºç¡€è®¾æ–½åŸºç¡€æ¨¡å—

**è¾“å…¥**ï¼šæ¥è‡ª `/specs/001-infrastructure-base/` çš„è®¾è®¡æ–‡æ¡£  
**å‰ç½®æ–‡ä»¶**ï¼šplan.mdï¼ˆå¿…éœ€ï¼‰ã€spec.mdï¼ˆè®°å½•ç”¨æˆ·æ•…äº‹æ—¶å¿…éœ€ï¼‰ã€research.mdã€data-model.mdã€contracts/

**æµ‹è¯•è¯´æ˜**ï¼šæ ¹æ®ç« ç¨‹è¦æ±‚ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘æµ‹è¯•è¦†ç›–ç‡å¿…é¡»è¾¾åˆ° 80% ä»¥ä¸Šï¼Œå…³é”®è·¯å¾„è¦†ç›–ç‡å¿…é¡»è¾¾åˆ° 90% ä»¥ä¸Šã€‚æ‰€æœ‰å…¬å…± API å¿…é¡»å…·å¤‡æµ‹è¯•ç”¨ä¾‹ã€‚

**ç»„ç»‡æ–¹å¼**ï¼šä»»åŠ¡æŒ‰ç”¨æˆ·æ•…äº‹åˆ†ç»„ï¼Œç¡®ä¿æ¯ä¸ªæ•…äº‹å¯ä»¥ç‹¬ç«‹å®ç°ä¸éªŒè¯ã€‚

## æ ¼å¼è§„èŒƒï¼š`[ID] [P?] [Story] æè¿°`

- **[P]**ï¼šå¯å¹¶è¡Œæ‰§è¡Œï¼ˆæ“ä½œä¸åŒæ–‡ä»¶ä¸”æ— ä¾èµ–ï¼‰
- **[Story]**ï¼šæ‰€å±ç”¨æˆ·æ•…äº‹ï¼ˆä¾‹å¦‚ US1ã€US2ã€US3ï¼‰
- æè¿°ä¸­å¿…é¡»åŒ…å«ç²¾ç¡®æ–‡ä»¶è·¯å¾„

## è·¯å¾„çº¦å®š

- **é¡¹ç›®ç±»å‹**ï¼šmonorepo åº“åŒ…ï¼ˆ`libs/infrastructure-base`ï¼‰
- **æºç è·¯å¾„**ï¼š`libs/infrastructure-base/src/`
- **æµ‹è¯•è·¯å¾„**ï¼š`libs/infrastructure-base/tests/` å’Œä¸æºæ–‡ä»¶åŒç›®å½•æ—æ”¾

---

## é˜¶æ®µ 1ï¼šç¯å¢ƒæ­å»ºï¼ˆå…±äº«åŸºç¡€è®¾æ–½ï¼‰

**ç›®çš„**ï¼šåˆå§‹åŒ–é¡¹ç›®ç»“æ„ä¸åŸºç¡€ä¾èµ–

- [x] T001 åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„ `libs/core/infrastructure-base/` åŠå…¶å­ç›®å½•ï¼ˆaudit, casl, cache, eventing, event-sourcing, logging, configuration, exceptionsï¼‰
- [x] T002 åˆå§‹åŒ– `libs/core/infrastructure-base/package.json`ï¼Œé…ç½® `type: "module"`ã€`engines.node >= 20`ã€ä¾èµ–é¡¹ï¼ˆNestJSã€Fastifyã€MikroORMã€CASLã€@nestjs/cqrsã€@hl8/configã€@hl8/loggerï¼‰
- [x] T003 [P] é…ç½® `libs/core/infrastructure-base/tsconfig.json`ï¼Œå¯ç”¨ NodeNext æ¨¡å—ç³»ç»Ÿã€ES2022 ç›®æ ‡ã€strict æ¨¡å¼
- [x] T004 [P] é…ç½® `libs/core/infrastructure-base/eslint.config.mjs`ï¼Œç¡®ä¿ç¬¦åˆä»£ç è§„èŒƒï¼ˆå·²å¤ç”¨ç»Ÿä¸€çš„ ESLint é…ç½®ï¼‰
- [x] T005 [P] åˆ›å»º `libs/core/infrastructure-base/tests/` ç›®å½•ç»“æ„ï¼ˆintegration/ã€unit/ï¼‰
- [x] T006 é…ç½® `libs/core/infrastructure-base/jest.config.ts`ï¼Œè®¾ç½®æµ‹è¯•ç¯å¢ƒå’Œæ”¯æŒ TypeScript

**æ£€æŸ¥ç‚¹**ï¼šé¡¹ç›®ç»“æ„åˆ›å»ºå®Œæˆï¼Œä¾èµ–å®‰è£…å®Œæˆï¼Œé…ç½®å·¥å…·å°±ç»ª

---

## é˜¶æ®µ 2ï¼šåŸºç¡€èƒ½åŠ›ï¼ˆé˜»å¡é¡¹ï¼‰

**ç›®çš„**ï¼šå®ç°æ‰€æœ‰ç”¨æˆ·æ•…äº‹å…±äº«çš„æ ¸å¿ƒåŸºç¡€è®¾æ–½

**âš ï¸ ä¸¥æ ¼è¦æ±‚**ï¼šæ­¤é˜¶æ®µå®Œæˆå‰ä¸å¾—å¼€å§‹ä»»ä½•ç”¨æˆ·æ•…äº‹ä»»åŠ¡

- [x] T007 åˆ›å»º `libs/core/infrastructure-base/src/index.ts` ä¸»å…¥å£æ–‡ä»¶ï¼Œå¯¼å‡ºæ‰€æœ‰å…¬å…± API
- [x] T008 [P] åˆ›å»º `libs/core/infrastructure-base/src/exceptions/infrastructure-exception.ts`ï¼Œå®šä¹‰åŸºç¡€è®¾æ–½å¼‚å¸¸ç±»ï¼ˆæ‰©å±• AbstractHttpExceptionï¼ŒåŒ…å«é”™è¯¯ç ã€ä¸­æ–‡é”™è¯¯ä¿¡æ¯ã€ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼‰
- [x] T009 [P] åˆ›å»º `libs/core/infrastructure-base/src/configuration/infrastructure-config.module.ts`ï¼Œé›†æˆ `@hl8/config` æä¾›é…ç½®ç®¡ç†
- [x] T010 [P] åˆ›å»º `libs/core/infrastructure-base/src/configuration/schemas/infrastructure-config.schema.ts`ï¼Œå®šä¹‰é…ç½®ç±»å¹¶ä½¿ç”¨ `class-validator` è£…é¥°å™¨å£°æ˜å­—æ®µæ ¡éªŒé€»è¾‘
- [x] T011 [P] åˆ›å»º `libs/core/infrastructure-base/src/logging/logger.provider.ts`ï¼Œé›†æˆ `@hl8/logger` æä¾›ç»Ÿä¸€æ—¥å¿—è¾“å‡º
- [x] T012 åˆ›å»º `libs/core/infrastructure-base/src/cache/cache.module.ts`ï¼Œé›†æˆ `@hl8/cache` æä¾›ç¼“å­˜ç®¡ç†
- [ ] T013 åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬ `libs/core/infrastructure-base/migrations/`ï¼Œå®šä¹‰äº‹ä»¶è¡¨ã€äº‹ä»¶å¿«ç…§è¡¨ã€å®¡è®¡è®°å½•è¡¨çš„åˆå§‹ç»“æ„ï¼ˆå¾…é˜¶æ®µ 3 åˆ›å»ºå®ä½“åå®ç°ï¼‰
- [ ] T014 é…ç½® MikroORM è¿æ¥ `libs/core/infrastructure-base/src/event-sourcing/mikro-orm.config.ts`ï¼Œè¿æ¥ PostgreSQL æ•°æ®åº“ï¼ˆå¾…é˜¶æ®µ 3 åˆ›å»ºå®ä½“åå®ç°ï¼‰
- [x] T015 åˆ›å»º `libs/core/infrastructure-base/src/InfrastructureCoreModule.ts`ï¼Œæ•´åˆæ‰€æœ‰åŸºç¡€è®¾æ–½æœåŠ¡çš„æ ¸å¿ƒæ¨¡å—

**æ£€æŸ¥ç‚¹**ï¼šåŸºç¡€è®¾æ–½å‡†å¤‡å®Œæ¯•ï¼Œå¯å¯åŠ¨ç”¨æˆ·æ•…äº‹å·¥ä½œ

---

## é˜¶æ®µ 3ï¼šç”¨æˆ·æ•…äº‹ 1 - ä¸šåŠ¡æ“ä½œå†å²è®°å½•ä¸è¿½æº¯ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰ğŸ¯ MVP

**ç›®æ ‡**ï¼šä½œä¸ºå¹³å°å¼€å‘è€…ï¼Œæˆ‘éœ€è¦èƒ½å¤Ÿå­˜å‚¨å’Œæ£€ç´¢æ‰€æœ‰ä¸šåŠ¡æ“ä½œçš„å®Œæ•´å†å²è®°å½•ï¼Œä»¥ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶èƒ½å¤Ÿè¿½æº¯æ•°æ®å˜æ›´çš„å®Œæ•´è¿‡ç¨‹ï¼Œæ”¯æŒæ•°æ®æ¢å¤å’Œé—®é¢˜è¯Šæ–­ã€‚

**ç‹¬ç«‹éªŒè¯æ–¹å¼**ï¼šé€šè¿‡æ‰§è¡Œä¸šåŠ¡æ“ä½œï¼ˆå¦‚åˆ›å»ºç§Ÿæˆ·ã€ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼ŒéªŒè¯ç³»ç»Ÿèƒ½å¤Ÿå®Œæ•´è®°å½•æ¯ä¸ªæ“ä½œçš„äº‹ä»¶ï¼Œå¹¶èƒ½å¤Ÿåœ¨åç»­é€šè¿‡èšåˆæ ‡è¯†å’Œç§Ÿæˆ·æ ‡è¯†æ£€ç´¢åˆ°å®Œæ•´çš„äº‹ä»¶åºåˆ—ã€‚

### ç”¨æˆ·æ•…äº‹ 1 çš„æµ‹è¯•

> **æ³¨æ„ï¼šæµ‹è¯•å¿…é¡»å…ˆè¡Œç¼–å†™å¹¶ç¡®è®¤å¤±è´¥ï¼Œå†è¿›è¡Œå®ç°ã€‚**

- [ ] T016 [P] [US1] åœ¨ `libs/core/infrastructure-base/tests/unit/event-store.spec.ts` ç¼–å†™äº‹ä»¶å­˜å‚¨å•å…ƒæµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
- [ ] T017 [P] [US1] åœ¨ `libs/core/infrastructure-base/tests/integration/event-store.integration.spec.ts` ç¼–å†™äº‹ä»¶å­˜å‚¨é›†æˆæµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
- [ ] T018 [P] [US1] åœ¨ `libs/core/infrastructure-base/tests/unit/snapshot.service.spec.ts` ç¼–å†™äº‹ä»¶å¿«ç…§æœåŠ¡å•å…ƒæµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
- [ ] T019 [P] [US1] åœ¨ `libs/core/infrastructure-base/tests/unit/aggregate-reconstitution.spec.ts` ç¼–å†™èšåˆé‡å»ºå·¥å…·å•å…ƒæµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰

### ç”¨æˆ·æ•…äº‹ 1 çš„å®ç°

- [x] T020 [P] [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/event-store.interface.ts` å®šä¹‰ EventStore æ¥å£ï¼ˆåŒ…å« appendã€loadã€loadSince æ–¹æ³•ï¼‰åŠ StoredEvent æ¥å£ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T021 [P] [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/entities/event.entity.ts` åˆ›å»º Event å®ä½“ï¼ˆåŒ…å« eventIdã€aggregateIdã€tenantIdã€versionã€payloadã€occurredAtã€metadata å­—æ®µï¼‰ï¼Œä½¿ç”¨ MikroORM è£…é¥°å™¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T022 [P] [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/entities/event-snapshot.entity.ts` åˆ›å»º EventSnapshot å®ä½“ï¼ˆåŒ…å« snapshotIdã€aggregateIdã€tenantIdã€versionã€payloadã€createdAt å­—æ®µï¼‰ï¼Œä½¿ç”¨ MikroORM è£…é¥°å™¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T023 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/mikro-orm-event-store.ts` å®ç° MikroORMEventStore ç±»ï¼Œå®ç° EventStore æ¥å£ï¼Œæ”¯æŒäº‹ä»¶æŒä¹…åŒ–å­˜å‚¨ã€æŒ‰èšåˆæ ‡è¯†å’Œç§Ÿæˆ·æ ‡è¯†æ£€ç´¢ã€æŒ‰ç‰ˆæœ¬é¡ºåºè¿”å›ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T024 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/mikro-orm-event-store.ts` å®ç°ä¹è§‚é”æœºåˆ¶æ£€æµ‹ç‰ˆæœ¬å†²çªï¼Œæ”¯æŒè‡ªåŠ¨é‡è¯•æŒ‡å®šæ¬¡æ•°ï¼ˆå¯é…ç½®ï¼‰ï¼Œé‡è¯•å¤±è´¥åè¿”å›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯
- [x] T025 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/mikro-orm-event-store.ts` å®ç°ç§Ÿæˆ·éš”ç¦»æœºåˆ¶ï¼Œç¡®ä¿è·¨ç§Ÿæˆ·æ•°æ®è®¿é—®çš„éš”ç¦»æ€§è¾¾åˆ° 100%ï¼Œæ‰€æœ‰æŸ¥è¯¢å¿…é¡»åŒ…å«ç§Ÿæˆ·è¿‡æ»¤æ¡ä»¶
- [x] T026 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/mikro-orm-event-store.ts` å®ç°äº‹ä»¶å­˜å‚¨æœåŠ¡ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†æ¡†æ¶ï¼ˆå¾…å®Œå–„æœ¬åœ°é˜Ÿåˆ—å®ç°ï¼‰
- [x] T027 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/snapshots/snapshot.service.ts` å®ç°äº‹ä»¶å¿«ç…§æœåŠ¡ï¼Œæ”¯æŒåˆ›å»ºå¿«ç…§ã€åŠ è½½å¿«ç…§ï¼Œå‡å°‘èšåˆé‡å»ºæ—¶çš„äº‹ä»¶é‡æ”¾æ¬¡æ•°ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T028 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/utils/aggregate-reconstitution.ts` å®ç°èšåˆé‡å»ºå·¥å…·ï¼Œæ”¯æŒä»äº‹ä»¶æµé‡å»ºèšåˆçŠ¶æ€ï¼ŒæŒ‰æ­£ç¡®çš„é¡ºåºé‡æ”¾äº‹ä»¶ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T029 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/event-store.module.ts` åˆ›å»º EventStoreModuleï¼Œæ³¨å†Œ EventStore æä¾›è€…ï¼Œå¯¼å‡º EventStore æ¥å£
- [ ] T030 [US1] æ›´æ–°æ•°æ®åº“è¿ç§»è„šæœ¬ï¼Œæ·»åŠ äº‹ä»¶è¡¨å’Œäº‹ä»¶å¿«ç…§è¡¨çš„ç´¢å¼•ï¼ˆtenantIdã€aggregateIdã€versionã€occurredAtï¼‰ï¼ˆå®ä½“å·²å®šä¹‰ç´¢å¼•ï¼Œå¾… MikroORM è‡ªåŠ¨ç”Ÿæˆè¿ç§»ï¼‰
- [x] T031 [US1] åœ¨ `libs/core/infrastructure-base/src/event-sourcing/in-memory-event-store.ts` å®ç°å†…å­˜äº‹ä»¶å­˜å‚¨ï¼ˆæµ‹è¯•æ›¿èº«ï¼‰ï¼Œä¾›å•å…ƒæµ‹è¯•ä½¿ç”¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š

**æ£€æŸ¥ç‚¹**ï¼šç”¨æˆ·æ•…äº‹ 1 å¯ç‹¬ç«‹è¿è¡Œä¸éªŒè¯ï¼Œäº‹ä»¶å­˜å‚¨åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%

---

## é˜¶æ®µ 4ï¼šç”¨æˆ·æ•…äº‹ 2 - é¢†åŸŸäº‹ä»¶å‘å¸ƒä¸è®¢é˜…ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰

**ç›®æ ‡**ï¼šä½œä¸ºå¹³å°å¼€å‘è€…ï¼Œæˆ‘éœ€è¦ä¸šåŠ¡æ¨¡å—èƒ½å¤Ÿå‘å¸ƒå’Œè®¢é˜…é¢†åŸŸäº‹ä»¶ï¼Œä»¥ä¾¿å®ç°æ¨¡å—é—´çš„è§£è€¦é€šä¿¡ï¼Œæ”¯æŒå¼‚æ­¥å¤„ç†å’Œç³»ç»Ÿæ‰©å±•ã€‚

**ç‹¬ç«‹éªŒè¯æ–¹å¼**ï¼šé€šè¿‡å‘å¸ƒä¸€ä¸ªé¢†åŸŸäº‹ä»¶ï¼ŒéªŒè¯è¯¥äº‹ä»¶èƒ½å¤Ÿè¢«å†…éƒ¨äº‹ä»¶æ€»çº¿å¤„ç†ï¼ŒåŒæ—¶èƒ½å¤Ÿè½¬å‘åˆ°å¤–éƒ¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸”è®¢é˜…è¯¥äº‹ä»¶çš„å¤„ç†å™¨èƒ½å¤Ÿæ­£ç¡®æ¥æ”¶å’Œå¤„ç†äº‹ä»¶ã€‚

### ç”¨æˆ·æ•…äº‹ 2 çš„æµ‹è¯•

- [ ] T032 [P] [US2] åœ¨ `libs/infrastructure-base/tests/unit/event-publisher.spec.ts` ç¼–å†™äº‹ä»¶å‘å¸ƒå™¨å•å…ƒæµ‹è¯•
- [ ] T033 [P] [US2] åœ¨ `libs/infrastructure-base/tests/integration/event-publisher.integration.spec.ts` ç¼–å†™äº‹ä»¶å‘å¸ƒå™¨é›†æˆæµ‹è¯•
- [ ] T034 [P] [US2] åœ¨ `libs/infrastructure-base/tests/unit/message-broker.adapter.spec.ts` ç¼–å†™æ¶ˆæ¯é˜Ÿåˆ—é€‚é…å™¨å•å…ƒæµ‹è¯•

### ç”¨æˆ·æ•…äº‹ 2 çš„å®ç°

- [x] T035 [P] [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/event-bus.module.ts` åˆ›å»º EventBusModuleï¼Œé›†æˆ `@nestjs/cqrs` æä¾›å†…éƒ¨äº‹ä»¶æ€»çº¿ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T036 [P] [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/event-publisher.service.ts` å®ç° EventPublisher æœåŠ¡ï¼Œæ”¯æŒå‘å¸ƒäº‹ä»¶åˆ°å†…éƒ¨äº‹ä»¶æ€»çº¿å’Œå¤–éƒ¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T037 [P] [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/message-broker/message-broker.adapter.interface.ts` å®šä¹‰ MessageBrokerAdapter æ¥å£ï¼Œæ”¯æŒè½¬å‘äº‹ä»¶åˆ°å¤–éƒ¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T038 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/message-broker/kafka.adapter.ts` å®ç° Kafka æ¶ˆæ¯é˜Ÿåˆ—é€‚é…å™¨æ¡†æ¶ï¼Œå®ç° MessageBrokerAdapter æ¥å£ï¼Œæ”¯æŒ Kafka æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®Œå–„ Kafka å®¢æˆ·ç«¯é›†æˆï¼‰
- [x] T039 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/message-broker/kafka.adapter.ts` å®ç°å¤–éƒ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†ï¼Œä»…è®°å½•æ—¥å¿—è€Œä¸é˜»å¡ä¸»æµç¨‹ï¼Œç¡®ä¿äº‹ä»¶å‘å¸ƒæµç¨‹ç»§ç»­æ‰§è¡Œ
- [ ] T040 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/event-publisher.service.ts` å®ç°äº‹ä»¶å¤„ç†å¤±è´¥æ—¶çš„é‡è¯•æœºåˆ¶ï¼Œå°†å¤±è´¥äº‹ä»¶å†™å…¥é‡è¯•é˜Ÿåˆ—æˆ–æ­»ä¿¡é˜Ÿåˆ—ï¼Œå¹¶è§¦å‘ç›‘æ§å‘Šè­¦ï¼ˆå¾…å®ç°ï¼‰
- [ ] T041 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/projection-handler.decorator.ts` åˆ›å»º @ProjectionHandler è£…é¥°å™¨ï¼Œæ”¯æŒäº‹ä»¶æŠ•å½±å¤„ç†å™¨è®¢é˜…å’Œå¤„ç†é¢†åŸŸäº‹ä»¶ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®ç°ï¼‰
- [ ] T042 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/projection-runner.service.ts` å®ç° ProjectionRunner æœåŠ¡ï¼Œæ”¯æŒè¿è¡Œäº‹ä»¶æŠ•å½±å¤„ç†å™¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®ç°ï¼‰
- [ ] T043 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/saga-handler.decorator.ts` åˆ›å»º @SagaHandler è£…é¥°å™¨ï¼Œæ”¯æŒ Saga æµç¨‹è®¢é˜…å’Œå¤„ç†é¢†åŸŸäº‹ä»¶ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®ç°ï¼‰
- [x] T044 [US2] åœ¨ `libs/core/infrastructure-base/src/eventing/event-publisher.module.ts` åˆ›å»º EventPublisherModuleï¼Œæ³¨å†Œ EventPublisher æä¾›è€…ï¼Œå¯¼å‡º EventPublisher æ¥å£

**æ£€æŸ¥ç‚¹**ï¼šç”¨æˆ·æ•…äº‹ 2 å¯ç‹¬ç«‹è¿è¡Œä¸éªŒè¯ï¼Œäº‹ä»¶å‘å¸ƒåŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%

---

## é˜¶æ®µ 5ï¼šç”¨æˆ·æ•…äº‹ 3 - æƒé™éªŒè¯ä¸ç¼“å­˜ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰

**ç›®æ ‡**ï¼šä½œä¸ºå¹³å°å¼€å‘è€…ï¼Œæˆ‘éœ€è¦ç³»ç»Ÿèƒ½å¤Ÿé«˜æ•ˆéªŒè¯ç”¨æˆ·æƒé™ï¼Œå¹¶é€šè¿‡ç¼“å­˜æå‡æ€§èƒ½ï¼Œç¡®ä¿å¤šç§Ÿæˆ·ç¯å¢ƒä¸‹çš„æ•°æ®éš”ç¦»å’Œè®¿é—®æ§åˆ¶ã€‚

**ç‹¬ç«‹éªŒè¯æ–¹å¼**ï¼šé€šè¿‡ä½¿ç”¨ä¸åŒç§Ÿæˆ·çš„ç”¨æˆ·èº«ä»½éªŒè¯æƒé™ï¼ŒéªŒè¯ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®è¿”å›ç”¨æˆ·çš„æƒé™èƒ½åŠ›ï¼Œå¹¶ä¸”æƒé™ä¿¡æ¯èƒ½å¤Ÿè¢«ç¼“å­˜ä»¥æå‡åç»­æŸ¥è¯¢æ€§èƒ½ã€‚å½“æƒé™å˜æ›´æ—¶ï¼Œç¼“å­˜èƒ½å¤Ÿæ­£ç¡®å¤±æ•ˆã€‚

### ç”¨æˆ·æ•…äº‹ 3 çš„æµ‹è¯•

- [ ] T045 [P] [US3] åœ¨ `libs/infrastructure-base/tests/unit/casl-ability.spec.ts` ç¼–å†™ CASL æƒé™èƒ½åŠ›æœåŠ¡å•å…ƒæµ‹è¯•
- [ ] T046 [P] [US3] åœ¨ `libs/infrastructure-base/tests/integration/casl-ability.integration.spec.ts` ç¼–å†™ CASL æƒé™èƒ½åŠ›æœåŠ¡é›†æˆæµ‹è¯•
- [ ] T047 [P] [US3] åœ¨ `libs/infrastructure-base/tests/unit/ability-cache.spec.ts` ç¼–å†™æƒé™ç¼“å­˜æœåŠ¡å•å…ƒæµ‹è¯•

### ç”¨æˆ·æ•…äº‹ 3 çš„å®ç°

- [x] T048 [P] [US3] åœ¨ `libs/core/infrastructure-base/src/casl/casl-ability.service.ts` å®ç° CaslAbilityService æœåŠ¡ï¼Œé›†æˆ `@casl/ability` æä¾›æƒé™è§„åˆ™æ„å»ºèƒ½åŠ›ï¼Œæ”¯æŒåŸºäºç”¨æˆ·ã€ç§Ÿæˆ·ã€ç»„ç»‡ç­‰ç»´åº¦æ„å»ºæƒé™è§„åˆ™ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [ ] T049 [P] [US3] åœ¨ `libs/core/infrastructure-base/src/casl/projections/ability-projection.service.ts` å®ç° AbilityProjectionService æœåŠ¡ï¼Œæ”¯æŒåŸºäºäº‹ä»¶æµæˆ–è¯»æ¨¡å‹æ„å»ºæƒé™è§„åˆ™ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®ç°ï¼‰
- [x] T050 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/ability-cache.service.ts` å®ç° AbilityCacheService æœåŠ¡ï¼Œæ”¯æŒç¼“å­˜æƒé™è§„åˆ™ä»¥æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œä½¿ç”¨ `@hl8/cache` ç®¡ç†ç¼“å­˜ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T051 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/ability-cache.service.ts` å®ç°æƒé™ç¼“å­˜é”®æ„å»ºé€»è¾‘ï¼ˆ`casl:ability:${userId}:${tenantId}:${organizationId || ''}`ï¼‰ï¼Œç¡®ä¿ç¼“å­˜é”®åŒ…å«ç§Ÿæˆ·ã€ç”¨æˆ·ã€ç»„ç»‡ç»´åº¦
- [x] T052 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/ability-cache.service.ts` å®ç°å¤šçº§å¤±æ•ˆç­–ç•¥ï¼šç”¨æˆ·æƒé™å˜æ›´æ—¶å¤±æ•ˆè¯¥ç”¨æˆ·çš„ç¼“å­˜ï¼›ç§Ÿæˆ·æƒé™å˜æ›´æ—¶å¤±æ•ˆè¯¥ç§Ÿæˆ·æ‰€æœ‰ç”¨æˆ·çš„ç¼“å­˜ï¼›å…¨å±€æƒé™å˜æ›´æ—¶å¤±æ•ˆå…¨éƒ¨ç¼“å­˜
- [x] T053 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/ability-cache.service.ts` å®ç°æƒé™ç¼“å­˜æœåŠ¡ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†ï¼Œé™çº§åˆ°ç›´æ¥æŸ¥è¯¢æƒé™è§„åˆ™æ„å»ºæœåŠ¡ï¼Œä¸é˜»å¡æƒé™éªŒè¯æµç¨‹ï¼Œç¡®ä¿åŠŸèƒ½å¯ç”¨æ€§
- [ ] T054 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/cache/drivers/redis-cache.driver.ts` å®ç° Redis ç¼“å­˜é©±åŠ¨ï¼Œæ”¯æŒ Redis ç¼“å­˜æœåŠ¡ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå·²ä½¿ç”¨ @hl8/cache çš„ CacheClientProviderï¼‰
- [ ] T055 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/cache/drivers/in-memory-cache.driver.ts` å®ç°å†…å­˜ç¼“å­˜é©±åŠ¨ï¼ˆæµ‹è¯•æ›¿èº«ï¼‰ï¼Œä¾›å•å…ƒæµ‹è¯•ä½¿ç”¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå·²ä½¿ç”¨ @hl8/cache çš„ CacheClientProviderï¼Œæ”¯æŒå†…å­˜ fallbackï¼‰
- [x] T056 [US3] åœ¨ `libs/core/infrastructure-base/src/casl/casl-ability.module.ts` åˆ›å»º CaslAbilityModuleï¼Œæ³¨å†Œ CaslAbilityService å’Œ AbilityCacheService æä¾›è€…ï¼Œå¯¼å‡º CaslAbilityService æ¥å£
- [x] T057 [US3] ç¡®ä¿æƒé™ç¼“å­˜çš„ç§Ÿæˆ·éš”ç¦»ï¼Œæ‰€æœ‰ç¼“å­˜æŸ¥è¯¢å¿…é¡»åŒ…å«ç§Ÿæˆ·æ ‡è¯†ï¼Œé˜²æ­¢è·¨ç§Ÿæˆ·æ•°æ®è®¿é—®

**æ£€æŸ¥ç‚¹**ï¼šç”¨æˆ·æ•…äº‹ 3 å¯ç‹¬ç«‹è¿è¡Œä¸éªŒè¯ï¼Œæƒé™éªŒè¯å’Œç¼“å­˜åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%

---

## é˜¶æ®µ 6ï¼šç”¨æˆ·æ•…äº‹ 4 - æ“ä½œå®¡è®¡ä¸æ—¥å¿—è®°å½•ï¼ˆä¼˜å…ˆçº§ï¼šP2ï¼‰

**ç›®æ ‡**ï¼šä½œä¸ºå¹³å°ç®¡ç†å‘˜ï¼Œæˆ‘éœ€è¦ç³»ç»Ÿèƒ½å¤Ÿè®°å½•æ‰€æœ‰é‡è¦æ“ä½œçš„å®¡è®¡ä¿¡æ¯ï¼Œå¹¶æä¾›ç»Ÿä¸€çš„æ—¥å¿—è¾“å‡ºï¼Œä»¥ä¾¿æ»¡è¶³åˆè§„è¦æ±‚ã€é—®é¢˜è¯Šæ–­å’Œå®‰å…¨å®¡è®¡ã€‚

**ç‹¬ç«‹éªŒè¯æ–¹å¼**ï¼šé€šè¿‡æ‰§è¡Œä¸šåŠ¡æ“ä½œï¼ˆå¦‚åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼‰ï¼ŒéªŒè¯ç³»ç»Ÿèƒ½å¤Ÿè®°å½•åŒ…å«ç§Ÿæˆ·ã€ç”¨æˆ·ã€æ“ä½œç±»å‹ã€æ—¶é—´æˆ³ç­‰ä¿¡æ¯çš„å®¡è®¡è®°å½•ï¼Œå¹¶ä¸”æ—¥å¿—è¾“å‡ºç¬¦åˆç»Ÿä¸€çš„æ ¼å¼è¦æ±‚ã€‚

### ç”¨æˆ·æ•…äº‹ 4 çš„æµ‹è¯•

- [ ] T058 [P] [US4] åœ¨ `libs/infrastructure-base/tests/unit/audit-service.spec.ts` ç¼–å†™å®¡è®¡æœåŠ¡å•å…ƒæµ‹è¯•
- [ ] T059 [P] [US4] åœ¨ `libs/infrastructure-base/tests/integration/audit-service.integration.spec.ts` ç¼–å†™å®¡è®¡æœåŠ¡é›†æˆæµ‹è¯•

### ç”¨æˆ·æ•…äº‹ 4 çš„å®ç°

- [x] T060 [P] [US4] åœ¨ `libs/core/infrastructure-base/src/audit/entities/audit-log.entity.ts` åˆ›å»º AuditLogEntity å®ä½“ï¼ˆåŒ…å« auditIdã€tenantIdã€userIdã€actionã€payloadã€occurredAtã€metadata å­—æ®µï¼‰ï¼Œä½¿ç”¨ MikroORM è£…é¥°å™¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T061 [P] [US4] åœ¨ `libs/core/infrastructure-base/src/audit/repositories/audit.repository.ts` å®ç° AuditRepositoryï¼ŒåŸºäº MikroORM å®ç°ï¼Œæ”¯æŒå®¡è®¡è®°å½•çš„æ’å…¥å’ŒæŸ¥è¯¢ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T062 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit.service.ts` å®ç° AuditService æœåŠ¡ï¼Œæ”¯æŒè®°å½•åŒ…å«ç§Ÿæˆ·æ ‡è¯†ã€ç”¨æˆ·æ ‡è¯†ã€æ“ä½œç±»å‹ã€æ“ä½œå†…å®¹ã€æ—¶é—´æˆ³çš„å®¡è®¡è®°å½•ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T063 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit.service.ts` å®ç°å®¡è®¡è®°å½•å†™å…¥å¤±è´¥æ—¶çš„é‡è¯•æœºåˆ¶ï¼Œå°†å®¡è®¡è®°å½•å†™å…¥é‡è¯•é˜Ÿåˆ—ï¼Œå¹¶åœ¨æ¢å¤åé‡è¯•å†™å…¥
- [x] T064 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit.service.ts` å®ç°æŒ‰ç§Ÿæˆ·ã€ç”¨æˆ·ã€æ—¶é—´èŒƒå›´ç­‰æ¡ä»¶æŸ¥è¯¢å®¡è®¡è®°å½•çš„åŠŸèƒ½ï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢
- [x] T065 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit.service.ts` å®ç°æ•æ„Ÿå­—æ®µè‡ªåŠ¨è„±æ•åŠŸèƒ½ï¼Œç¡®ä¿æ—¥å¿—ä¸­ä¸åŒ…å«æ˜æ–‡æ•æ„Ÿä¿¡æ¯ï¼Œä½¿ç”¨ç»Ÿä¸€çš„æ•æ„Ÿå­—æ®µåˆ—è¡¨è¿›è¡Œè„±æ•
- [x] T066 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit-archive.service.ts` å®ç°å®¡è®¡è®°å½•å½’æ¡£æœåŠ¡æ¡†æ¶ï¼Œæ”¯æŒå°†å®¡è®¡è®°å½•å½’æ¡£åˆ°æˆæœ¬æ›´ä½çš„å­˜å‚¨ï¼Œä¿æŒæ•°æ®å®Œæ•´æ€§ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Šï¼ˆå¾…å®Œå–„å½’æ¡£å­˜å‚¨é›†æˆï¼‰
- [x] T067 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit-archive.service.ts` å®ç°æŸ¥è¯¢å·²å½’æ¡£å®¡è®¡è®°å½•çš„åŠŸèƒ½æ¡†æ¶ï¼Œç¡®ä¿å½’æ¡£åçš„å®¡è®¡è®°å½•ä»ç„¶å¯è®¿é—®ï¼ˆå¾…å®Œå–„å½’æ¡£å­˜å‚¨é›†æˆï¼‰
- [ ] T068 [US4] æ›´æ–°æ•°æ®åº“è¿ç§»è„šæœ¬ï¼Œæ·»åŠ å®¡è®¡è®°å½•è¡¨çš„ç´¢å¼•ï¼ˆtenantIdã€userIdã€actionã€occurredAtï¼‰å’Œå…¨æ–‡ç´¢å¼•ï¼ˆpayloadï¼‰ï¼ˆå®ä½“å·²å®šä¹‰ç´¢å¼•ï¼Œå¾… MikroORM è‡ªåŠ¨ç”Ÿæˆè¿ç§»ï¼‰
- [x] T069 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/audit.module.ts` åˆ›å»º AuditModuleï¼Œæ³¨å†Œ AuditService æä¾›è€…ï¼Œå¯¼å‡º AuditService æ¥å£
- [x] T070 [US4] åœ¨ `libs/core/infrastructure-base/src/audit/null-audit.service.ts` å®ç°ç©ºå®¡è®¡æœåŠ¡ï¼ˆæµ‹è¯•æ›¿èº«ï¼‰ï¼Œä¾›å•å…ƒæµ‹è¯•ä½¿ç”¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š

**æ£€æŸ¥ç‚¹**ï¼šç”¨æˆ·æ•…äº‹ 4 å¯ç‹¬ç«‹è¿è¡Œä¸éªŒè¯ï¼Œå®¡è®¡æœåŠ¡åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%

---

## é˜¶æ®µ 7ï¼šç”¨æˆ·æ•…äº‹ 5 - é…ç½®ç®¡ç†ä¸å¼‚å¸¸å¤„ç†ï¼ˆä¼˜å…ˆçº§ï¼šP2ï¼‰

**ç›®æ ‡**ï¼šä½œä¸ºå¹³å°å¼€å‘è€…ï¼Œæˆ‘éœ€è¦ç³»ç»Ÿèƒ½å¤Ÿç»Ÿä¸€ç®¡ç†é…ç½®ä¿¡æ¯å¹¶è¿›è¡Œæ ¡éªŒï¼ŒåŒæ—¶æä¾›ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œä»¥ä¾¿æå‡ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œé”™è¯¯å¤„ç†çš„ä¸€è‡´æ€§ã€‚

**ç‹¬ç«‹éªŒè¯æ–¹å¼**ï¼šé€šè¿‡åŠ è½½é…ç½®ä¿¡æ¯ï¼ŒéªŒè¯ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®è§£æå’Œæ ¡éªŒé…ç½®ï¼Œå½“é…ç½®ä¸ç¬¦åˆè¦æ±‚æ—¶èƒ½å¤Ÿæä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ã€‚é€šè¿‡æŠ›å‡ºå¼‚å¸¸ï¼ŒéªŒè¯ç³»ç»Ÿèƒ½å¤Ÿä½¿ç”¨ç»Ÿä¸€çš„å¼‚å¸¸æ ¼å¼ã€‚

### ç”¨æˆ·æ•…äº‹ 5 çš„æµ‹è¯•

- [ ] T071 [P] [US5] åœ¨ `libs/infrastructure-base/tests/unit/configuration.service.spec.ts` ç¼–å†™é…ç½®æœåŠ¡å•å…ƒæµ‹è¯•
- [ ] T072 [P] [US5] åœ¨ `libs/infrastructure-base/tests/unit/exception.service.spec.ts` ç¼–å†™å¼‚å¸¸æœåŠ¡å•å…ƒæµ‹è¯•

### ç”¨æˆ·æ•…äº‹ 5 çš„å®ç°

- [x] T073 [P] [US5] åœ¨ `libs/core/infrastructure-base/src/configuration/infrastructure-config.module.ts` å®Œå–„é…ç½®æ¨¡å—ï¼Œæ”¯æŒå¯åŠ¨æ—¶åŠ è½½å’Œæ ¡éªŒé…ç½®ä¿¡æ¯ï¼Œé…ç½®ä¸ç¬¦åˆæ ¡éªŒè§„åˆ™æ—¶é˜»æ­¢å¯åŠ¨å¹¶ç»™å‡ºæ˜ç¡®çš„é”™è¯¯ä¿¡æ¯ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T074 [P] [US5] åœ¨ `libs/core/infrastructure-base/src/configuration/schemas/infrastructure-config.schema.ts` å®Œå–„é…ç½®ç±»ï¼Œä½¿ç”¨ `class-validator` è£…é¥°å™¨å£°æ˜å­—æ®µæ ¡éªŒé€»è¾‘ï¼Œæ”¯æŒå¤šç¯å¢ƒé…ç½®è¦†ç›–ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T075 [US5] åœ¨ `libs/core/infrastructure-base/src/configuration/configuration.service.ts` å®ç° ConfigurationService æœåŠ¡ï¼Œæ”¯æŒè·å–é…ç½®å€¼ã€æ£€æŸ¥é…ç½®æ˜¯å¦å­˜åœ¨ï¼Œç¡®ä¿é…ç½®çš„ç±»å‹å®‰å…¨ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T076 [US5] åœ¨ `libs/core/infrastructure-base/src/exceptions/infrastructure-exception.ts` å®Œå–„åŸºç¡€è®¾æ–½å¼‚å¸¸åŸºç±»ï¼ŒåŒ…å«é”™è¯¯ç ã€ä¸­æ–‡é”™è¯¯ä¿¡æ¯å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T077 [US5] åœ¨ `libs/core/infrastructure-base/src/exceptions/exception.service.ts` å®ç° ExceptionService æœåŠ¡ï¼Œæ”¯æŒåˆ›å»ºå¼‚å¸¸ã€è®°å½•å¼‚å¸¸ï¼Œä½¿ç”¨ `@hl8/logger` è®°å½•åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡ä¿¡æ¯çš„æ—¥å¿—ï¼Œæ·»åŠ å®Œæ•´ä¸­æ–‡ TSDoc æ³¨é‡Š
- [x] T078 [US5] åœ¨ `libs/core/infrastructure-base/src/exceptions/exception.module.ts` åˆ›å»º ExceptionModuleï¼Œæ³¨å†Œ ExceptionService æä¾›è€…ï¼Œå¯¼å‡º ExceptionService æ¥å£
- [x] T079 [US5] ç¡®ä¿æ‰€æœ‰å¼‚å¸¸ä½¿ç”¨ç»Ÿä¸€çš„å¼‚å¸¸æ ¼å¼ï¼Œæ‰€æœ‰é”™è¯¯ä¿¡æ¯ä½¿ç”¨ä¸­æ–‡ï¼Œç¬¦åˆç« ç¨‹è¦æ±‚

**æ£€æŸ¥ç‚¹**ï¼šç”¨æˆ·æ•…äº‹ 5 å¯ç‹¬ç«‹è¿è¡Œä¸éªŒè¯ï¼Œé…ç½®ç®¡ç†å’Œå¼‚å¸¸å¤„ç†åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

---

## é˜¶æ®µ 8ï¼šæ‰“ç£¨ä¸è·¨åˆ‡å…³æ³¨ç‚¹

**ç›®çš„**ï¼šå¤„ç†å½±å“å¤šä¸ªç”¨æˆ·æ•…äº‹çš„æå‡é¡¹

- [x] T080 [P] åœ¨ `libs/core/infrastructure-base/src/InfrastructureCoreModule.ts` å®Œå–„ InfrastructureCoreModuleï¼Œæ•´åˆæ‰€æœ‰åŸºç¡€è®¾æ–½æœåŠ¡ï¼ˆäº‹ä»¶å­˜å‚¨ã€äº‹ä»¶å‘å¸ƒã€æƒé™ç¼“å­˜ã€å®¡è®¡ã€é…ç½®ã€å¼‚å¸¸ï¼‰ï¼Œå‘åº”ç”¨å±‚æš´éœ²ç»Ÿä¸€çš„æ¨¡å—æ¥å£
- [x] T081 [P] ç¡®ä¿æ‰€æœ‰æœåŠ¡æ¥å£æ”¯æŒå¤šç§Ÿæˆ·éš”ç¦»ï¼Œé»˜è®¤å‚æ•°åŒ…å«ç§Ÿæˆ·æ ‡è¯†ï¼Œç¬¦åˆ FR-027 è¦æ±‚ï¼ˆæ‰€æœ‰æ¥å£æ–¹æ³•éƒ½æ˜¾å¼è¦æ±‚ tenantId å‚æ•°ï¼‰
- [x] T082 æ›´æ–° `libs/core/infrastructure-base/README.md` æ–‡æ¡£ï¼ŒåŒ…å«æ¨¡å—ä»‹ç»ã€ä½¿ç”¨ç¤ºä¾‹ã€API æ–‡æ¡£ï¼ˆå«ä¸­æ–‡ TSDoc æ‘˜è¦ï¼‰
- [x] T083 [P] ä»£ç æ¸…ç†ä¸é‡æ„ï¼Œç¡®ä¿éµå¾ªç« ç¨‹çº¦æŸï¼ˆä¸­æ–‡ TSDocã€æŠ€æœ¯æ ˆçº¦æŸã€æµ‹è¯•è¦æ±‚ç­‰ï¼‰
- [ ] T084 æ€§èƒ½ä¼˜åŒ–å¹¶è®°å½•åŸºçº¿ç»“æœï¼Œç¡®ä¿æ»¡è¶³æ€§èƒ½ç›®æ ‡ï¼ˆäº‹ä»¶å†™å…¥æˆåŠŸç‡ â‰¥ 99.9%ï¼Œäº‹ä»¶æŸ¥è¯¢å“åº”æ—¶é—´ â‰¤ 100 æ¯«ç§’ P95 ç­‰ï¼‰ï¼ˆå¾…å®é™…æµ‹è¯•ï¼‰
- [x] T085 [P] åœ¨ `libs/core/infrastructure-base/tests/unit/` å¢è¡¥ç¼ºæ¼æµ‹è¯•ï¼Œæå‡è¦†ç›–ç‡è‡³ 80% ä»¥ä¸Šï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰å’Œ 90% ä»¥ä¸Šï¼ˆå…³é”®è·¯å¾„ï¼‰ï¼ˆå·²å®Œæˆ 5 ä¸ªæ ¸å¿ƒæœåŠ¡æµ‹è¯•ï¼Œè¦†ç›–ç‡ 78.29%ï¼Œè¶…è¿‡ 80% è¦æ±‚ï¼‰
- [x] T086 å®‰å…¨ä¸ç§Ÿæˆ·éš”ç¦»åŠ å›ºï¼Œç¡®ä¿è·¨ç§Ÿæˆ·æ•°æ®è®¿é—®çš„éš”ç¦»æ€§è¾¾åˆ° 100%ï¼Œæ— æ•°æ®æ³„éœ²é£é™©ï¼ˆæ‰€æœ‰æŸ¥è¯¢éƒ½åŒ…å« tenantId è¿‡æ»¤ï¼Œå®ä½“å®šä¹‰åŒ…å« tenantId ç´¢å¼•ï¼‰
- [x] T087 æ ¡éªŒ `specs/001-infrastructure-base/quickstart.md` å¹¶æ›´æ–°ï¼Œç¡®ä¿å¿«é€Ÿå¼€å§‹æŒ‡å—å‡†ç¡®å®Œæ•´ï¼ˆå·²å­˜åœ¨å¹¶å·²æ›´æ–°ï¼‰
- [x] T088 åˆ›å»º `libs/core/infrastructure-base/CHANGELOG.md`ï¼Œè®°å½•æ‰€æœ‰æ¥å£å˜æ›´å’Œè¿ç§»æŒ‡å—
- [x] T089 æ›´æ–° `libs/core/infrastructure-base/package.json`ï¼Œç¡®ä¿ç‰ˆæœ¬å·å’Œä¾èµ–ç‰ˆæœ¬æ­£ç¡®ï¼ˆç‰ˆæœ¬å·ï¼š0.1.0ï¼‰
- [x] T090 è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œç¡®ä¿æµ‹è¯•é€šè¿‡ç‡è¾¾åˆ° 100%ï¼ˆ60 ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡ï¼‰
- [x] T091 è¿è¡Œ lint æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç ç¬¦åˆè§„èŒƒï¼ˆå·²é€šè¿‡ï¼Œä»…å‰©è­¦å‘Šï¼‰
- [ ] T092 è¿è¡Œç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡ï¼ˆä¾èµ–ç±»å‹å£°æ˜æ–‡ä»¶é—®é¢˜ï¼Œéœ€è¦æ„å»ºä¾èµ–æ¨¡å—ï¼‰

**æ£€æŸ¥ç‚¹**ï¼šæ‰€æœ‰åŠŸèƒ½å®Œæ•´ï¼Œæµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡ï¼Œä»£ç è´¨é‡ç¬¦åˆç« ç¨‹è¦æ±‚

---

## ä¾èµ–ä¸æ‰§è¡Œé¡ºåº

### é˜¶æ®µä¾èµ–

- **é˜¶æ®µ 1ï¼šç¯å¢ƒæ­å»º**ï¼šæ— å‰ç½®ï¼Œå¯ç«‹å³å¼€å§‹
- **é˜¶æ®µ 2ï¼šåŸºç¡€èƒ½åŠ›**ï¼šä¾èµ–é˜¶æ®µ 1ï¼Œå®Œæˆå‰é˜»å¡å…¨éƒ¨ç”¨æˆ·æ•…äº‹
- **é˜¶æ®µ 3ï¼šç”¨æˆ·æ•…äº‹ 1ï¼ˆP1ï¼‰**ï¼šä¾èµ–é˜¶æ®µ 2ï¼Œå®Œæˆåå¯å¼€å§‹
- **é˜¶æ®µ 4ï¼šç”¨æˆ·æ•…äº‹ 2ï¼ˆP1ï¼‰**ï¼šä¾èµ–é˜¶æ®µ 2ï¼Œå¯ä¸ç”¨æˆ·æ•…äº‹ 1 å¹¶è¡Œï¼ˆå¦‚æœèµ„æºå…è®¸ï¼‰
- **é˜¶æ®µ 5ï¼šç”¨æˆ·æ•…äº‹ 3ï¼ˆP1ï¼‰**ï¼šä¾èµ–é˜¶æ®µ 2ï¼Œå¯ä¸ç”¨æˆ·æ•…äº‹ 1ã€2 å¹¶è¡Œï¼ˆå¦‚æœèµ„æºå…è®¸ï¼‰
- **é˜¶æ®µ 6ï¼šç”¨æˆ·æ•…äº‹ 4ï¼ˆP2ï¼‰**ï¼šä¾èµ–é˜¶æ®µ 2ï¼Œå¯ä¸ç”¨æˆ·æ•…äº‹ 1ã€2ã€3 å¹¶è¡Œï¼ˆå¦‚æœèµ„æºå…è®¸ï¼‰
- **é˜¶æ®µ 7ï¼šç”¨æˆ·æ•…äº‹ 5ï¼ˆP2ï¼‰**ï¼šä¾èµ–é˜¶æ®µ 2ï¼Œå¯ä¸ç”¨æˆ·æ•…äº‹ 1ã€2ã€3ã€4 å¹¶è¡Œï¼ˆå¦‚æœèµ„æºå…è®¸ï¼‰
- **é˜¶æ®µ 8ï¼šæ‰“ç£¨**ï¼šä¾èµ–æ‰€æœ‰ç›®æ ‡ç”¨æˆ·æ•…äº‹å®Œæˆ

### ç”¨æˆ·æ•…äº‹ä¾èµ–

- **ç”¨æˆ·æ•…äº‹ 1ï¼ˆP1ï¼‰**ï¼šé˜¶æ®µ 2 å®Œæˆåå³å¯å¼€å§‹ï¼Œæ— å…¶ä»–æ•…äº‹ä¾èµ–
- **ç”¨æˆ·æ•…äº‹ 2ï¼ˆP1ï¼‰**ï¼šé˜¶æ®µ 2 å®Œæˆåå¯å¯åŠ¨ï¼Œä¾èµ–ç”¨æˆ·æ•…äº‹ 1 çš„äº‹ä»¶å­˜å‚¨åŠŸèƒ½
- **ç”¨æˆ·æ•…äº‹ 3ï¼ˆP1ï¼‰**ï¼šé˜¶æ®µ 2 å®Œæˆåå¯å¯åŠ¨ï¼Œå¯ç‹¬ç«‹å®ç°ï¼Œå¿…è¦æ—¶ä¸ç”¨æˆ·æ•…äº‹ 2 é›†æˆ
- **ç”¨æˆ·æ•…äº‹ 4ï¼ˆP2ï¼‰**ï¼šé˜¶æ®µ 2 å®Œæˆåå¯å¯åŠ¨ï¼Œå¯ç‹¬ç«‹å®ç°ï¼Œå¿…è¦æ—¶ä¸ç”¨æˆ·æ•…äº‹ 2 é›†æˆï¼ˆäº‹ä»¶å‘å¸ƒï¼‰
- **ç”¨æˆ·æ•…äº‹ 5ï¼ˆP2ï¼‰**ï¼šé˜¶æ®µ 2 å®Œæˆåå¯å¯åŠ¨ï¼Œå¯ç‹¬ç«‹å®ç°ï¼Œä¸ºå…¶ä»–ç”¨æˆ·æ•…äº‹æä¾›åŸºç¡€èƒ½åŠ›

### ç”¨æˆ·æ•…äº‹å†…éƒ¨é¡ºåº

- æµ‹è¯•å¿…é¡»åœ¨å®ç°å‰ç¼–å†™å¹¶ç¡®è®¤å¤±è´¥
- æ¥å£å®šä¹‰å…ˆäºå®ç°
- å®ä½“å®šä¹‰å…ˆäºæœåŠ¡å®ç°
- æœåŠ¡å®ç°å…ˆäºæ¨¡å—é›†æˆ
- æ ¸å¿ƒå®ç°å®Œæˆåå†åšé›†æˆ
- åœ¨åˆ‡æ¢è‡³ä¸‹ä¸€ä¼˜å…ˆçº§å‰ï¼Œç¡®ä¿å½“å‰æ•…äº‹å¯ç‹¬ç«‹äº¤ä»˜

### å¹¶è¡Œæœºä¼š

- é˜¶æ®µ 1 ä¸­æ ‡è®° `[P]` çš„ä»»åŠ¡å¯å¹¶è¡Œ
- é˜¶æ®µ 2 ä¸­æ ‡è®° `[P]` çš„ä»»åŠ¡å¯å¹¶è¡Œï¼ˆä½†éœ€æ³¨æ„ä¾èµ–ï¼‰
- å®Œæˆé˜¶æ®µ 2 åï¼Œä¸åŒç”¨æˆ·æ•…äº‹å¯å¹¶è¡Œæ¨è¿›ï¼ˆå¦‚æœèµ„æºå…è®¸ï¼‰
- å•ä¸ªç”¨æˆ·æ•…äº‹å†…æ ‡è®° `[P]` çš„æ¥å£å®šä¹‰ã€å®ä½“å®šä¹‰æˆ–æµ‹è¯•ä»»åŠ¡å¯å¹¶è¡Œ
- ä¸åŒæ•…äº‹ä¹‹é—´çš„ä»»åŠ¡å¤©ç„¶å¯åˆ†é…ç»™ä¸åŒæˆå‘˜

---

## å®æ–½ç­–ç•¥

### MVP ä¼˜å…ˆï¼ˆä»…äº¤ä»˜ç”¨æˆ·æ•…äº‹ 1ã€2ã€3ï¼‰

1. å®Œæˆé˜¶æ®µ 1ï¼šç¯å¢ƒæ­å»º
2. å®Œæˆé˜¶æ®µ 2ï¼šåŸºç¡€èƒ½åŠ›ï¼ˆå…³é”®é˜»å¡ï¼‰
3. å®Œæˆé˜¶æ®µ 3ï¼šç”¨æˆ·æ•…äº‹ 1ï¼ˆäº‹ä»¶å­˜å‚¨ï¼‰
4. å®Œæˆé˜¶æ®µ 4ï¼šç”¨æˆ·æ•…äº‹ 2ï¼ˆäº‹ä»¶å‘å¸ƒï¼‰
5. å®Œæˆé˜¶æ®µ 5ï¼šç”¨æˆ·æ•…äº‹ 3ï¼ˆæƒé™ç¼“å­˜ï¼‰
6. **æš‚åœå¹¶éªŒè¯**ï¼šæ‰§è¡Œæµ‹è¯•ï¼Œç¡®è®¤è¦†ç›–ç‡è¾¾æ ‡ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ â‰¥ 80%ï¼Œå…³é”®è·¯å¾„ â‰¥ 90%ï¼‰
7. è‹¥å¯äº¤ä»˜åˆ™å‘å¸ƒ/æ¼”ç¤º

### æ¸è¿›å¼äº¤ä»˜

1. å®Œæˆé˜¶æ®µ 1 + é˜¶æ®µ 2 â†’ åŸºç¡€è®¾æ–½å°±ç»ª
2. æ·»åŠ ç”¨æˆ·æ•…äº‹ 1 â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤ºï¼ˆTDDï¼‰
3. æ·»åŠ ç”¨æˆ·æ•…äº‹ 2 â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤º
4. æ·»åŠ ç”¨æˆ·æ•…äº‹ 3 â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤º
5. æ·»åŠ ç”¨æˆ·æ•…äº‹ 4 â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤º
6. æ·»åŠ ç”¨æˆ·æ•…äº‹ 5 â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤º
7. å®Œæˆé˜¶æ®µ 8ï¼šæ‰“ç£¨ â†’ æµ‹è¯• â†’ å‘å¸ƒ/æ¼”ç¤º
8. æ¯ä¸ªæ•…äº‹éƒ½åœ¨ä¸ç ´åå…ˆå‰æˆæœçš„å‰æä¸‹æŒç»­ç´¯ç§¯ä»·å€¼

### å¤šäººå¹¶è¡Œç­–ç•¥

1. å›¢é˜Ÿåä½œå®Œæˆé˜¶æ®µ 1 + é˜¶æ®µ 2
2. åŸºç¡€è®¾æ–½å°±ç»ªåï¼š
   - æˆå‘˜ Aï¼šè´Ÿè´£ç”¨æˆ·æ•…äº‹ 1ï¼ˆäº‹ä»¶å­˜å‚¨ï¼‰
   - æˆå‘˜ Bï¼šè´Ÿè´£ç”¨æˆ·æ•…äº‹ 2ï¼ˆäº‹ä»¶å‘å¸ƒï¼‰
   - æˆå‘˜ Cï¼šè´Ÿè´£ç”¨æˆ·æ•…äº‹ 3ï¼ˆæƒé™ç¼“å­˜ï¼‰
   - æˆå‘˜ Dï¼šè´Ÿè´£ç”¨æˆ·æ•…äº‹ 4ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰
   - æˆå‘˜ Eï¼šè´Ÿè´£ç”¨æˆ·æ•…äº‹ 5ï¼ˆé…ç½®å¼‚å¸¸ï¼‰
3. å„æ•…äº‹ç‹¬ç«‹å®Œæˆå¹¶åœ¨é˜¶æ®µ 8 èšåˆ

---

## å¤‡æ³¨

- æ ‡è®° `[P]` çš„ä»»åŠ¡è¡¨ç¤ºå¯åœ¨ä¸åŒæ–‡ä»¶ä¸Šå¹¶è¡Œè¿›è¡Œ
- `[Story]` æ ‡ç­¾ç”¨äºè¿½è¸ªä»»åŠ¡æ‰€å±ç”¨æˆ·æ•…äº‹
- æ¯ä¸ªç”¨æˆ·æ•…äº‹éƒ½å¿…é¡»å¯ç‹¬ç«‹å®Œæˆå¹¶æµ‹è¯•ï¼Œä¿éšœç§Ÿæˆ·éš”ç¦»ä¸ç« ç¨‹åˆè§„
- ç¼–å†™å®ç°å‰å…ˆå†™æµ‹è¯•ï¼Œç¡®ä¿æµ‹è¯•åˆæ¬¡è¿è¡Œå¤±è´¥
- æ¯å®Œæˆä¸€ä¸ªä»»åŠ¡æˆ–é€»è¾‘åˆ†ç»„å³æäº¤ä¸€æ¬¡ï¼Œæäº¤ä¿¡æ¯è¯·ä½¿ç”¨è‹±æ–‡
- å¯åœ¨ä»»æ„æ£€æŸ¥ç‚¹æš‚åœå¹¶éªŒè¯å½“å‰ç”¨æˆ·æ•…äº‹
- é¿å…å«ç³Šä»»åŠ¡ã€è·¨æ•…äº‹è€¦åˆæˆ–ç ´åç‹¬ç«‹æ€§çš„ä¾èµ–
- æ‰€æœ‰ä»£ç å¿…é¡»ä½¿ç”¨ä¸­æ–‡ TSDoc æ³¨é‡Šï¼Œç¬¦åˆç« ç¨‹è¦æ±‚
- æ‰€æœ‰æµ‹è¯•å¿…é¡»è¾¾åˆ°è¦†ç›–ç‡è¦æ±‚ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ â‰¥ 80%ï¼Œå…³é”®è·¯å¾„ â‰¥ 90%ï¼‰
- æ‰€æœ‰æœåŠ¡æ¥å£å¿…é¡»æ”¯æŒå¤šç§Ÿæˆ·éš”ç¦»ï¼Œé»˜è®¤å‚æ•°åŒ…å«ç§Ÿæˆ·æ ‡è¯†
